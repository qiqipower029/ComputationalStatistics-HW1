---
title: "HW1"
author: "Jieqi Tu"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

##  Question 1

#### (a)
$$\int^{\infty}_{0} x(1+x^{2})^{-2} dx$$\
Set $u = (1+x^2)$, then we can get: $\int^{\infty}_{0} x(1+x^{2})^{-2} dx = \frac{1}{2}\int^{\infty}_{1}u^{-2}du=\frac{1}{2}$\
In order to transform $\int^{\infty}_{0}$ to $\int^{1}_{0}$, set $y=\frac{1}{1+x}$.\
So $dx=-\frac{1}{y^2}dy$. Then we have $\int^{0}_{1}-\frac{1}{y^2}\frac{(1/y-1)}{(1+(1/y-1)^2)^{2}}dy$.
```{r question1 a}
# set seed
set.seed(1029)

# check theoretical value of the given integral using R:
integral_a = function(x) {
  x*(1+x^{2})^{-2}
}
integrate(integral_a, lower = 0, upper = Inf)$value
# simulate using uniform distribution
s = runif(100000)
transform = (1/s^2)*(1/s-1)/(1+(1/s-1)^2)^2
mean(transform)
```


#### (b)
$$\int^{\infty}_{-\infty} e^{-x^2}dx$$\
Because we already know the probability density function of Normal distribution: $f(x)=\frac{1}{\sigma \sqrt{2\pi}}e^{-\frac{1}{2}\frac{(x-\mu)^2}{\sigma^2}}$, we can let $\mu=1$, $\sigma=1/\sqrt{2}$.
Then according to the property of probability density function, we have: $\int^{\infty}_{-\infty} e^{x^2}dx = \sqrt{\pi}$\
To transform upper bound and lower bound, let $y = \frac{e^x}{1+e^x}$. Then we have $\int^{1}_{0} e^{\frac{logit^2(y)}{y(1-y)}}dy$

```{r question 1 b}
# set seed
set.seed(1029)

# check theoretical value of the given integral using R:
integral_b = function(x) {
  exp(-x^2)
}
integrate(integral_b, lower = -Inf, upper = Inf)$value
# simulate using uniform distribution
s = runif(100000)
transform = exp(-(log(s/(1-s)))^2)/(s*(1-s))
mean(transform)
```

#### (c)
$$\int^{4}_{2} ln{x}dx$$\
$\int^{4}_{2} lnxdx=xln{x}|_{2}^{4}-\int^{4}_{2} xdlnx=4ln4-2ln2-2\approx2.1588$. To transform the upper and lower bound, set $y=\frac{x-2}{2}$. Then we have$\int^{1}_{0} 2ln{(2y+2)}dy$.
```{r question 1 c}
# set seed
set.seed(1029)

# check theoretical value of the given integral using R:
integral_c = function(x) {
  log(x)
}
integrate(integral_c, lower = 2, upper = 4)$value
# simulate using uniform distribution
s = runif(1000000000)
transform = 2*log(2*s+2)
mean(transform)
```

#### (d)

$$\int^{1}_{0}\int^{1}_{0} e^{x+y} dxdy$$\
The exact value of this integral is $\int^{1}_{0}e^xdx\int^{1}_{0} e^{y}dy=(e-1)^2\approx2.952492$.
```{r question 1 d}
# set seed
set.seed(1029)

# simulate using uniform distribution
x = runif(100000)
y = runif(100000)
transform = exp(x+y)
mean(transform)
```

## Question 2
$Cov(U,\sqrt{1-U^2}=E(U^2\sqrt{1-U^2})-E(U^2)E(\sqrt{1-U^2})$.\
$E(U^2)=\int^{1}_{0}u^2du=u/3|^{1}_{0}=\frac{1}{3}$.\
Let $u=sin\theta, du/d\theta=cos\theta$. Then $E(U^2\sqrt{1-U^2})=\int^{\pi/2}_{0}sin^2\theta cos^2\theta d\theta=\int^{\pi/2}_{0}\frac{1}{4}sin^22\theta d\theta=\frac{1}{8}\int^{\pi/2}_{0}1-cos4\theta d\theta=\frac{\pi}{16}$\
$E(\sqrt{1-U^2})= \int_{0}^{1}\sqrt{1-u^2}du=\int_{0}^{\pi/2}cos\theta dsin\theta=\int_{0}^{\pi/2}cos^2\theta d\theta = \int_{0}^{\pi/2}\frac{1+cos2\theta}{2}d\theta=\\\int_{0}^{\pi/2}(\frac{1}{2}\theta+\frac{1}{4}sin2\theta)d\theta=\frac{\pi}{4}$\
$Cov(U^2,\sqrt{1-U^2})=\frac{\pi}{16}-\frac{1}{3}\times\frac{\pi}{4}\approx-0.06544985$
```{r question 2}
# set seed
set.seed(1029)

# simulate
u = runif(1000000)
y = u^2
z = sqrt(1 - y)
cov(y, z)
```

## Question 3
```{r question 3}
# set seed
set.seed(1029)

# simulate
sim_n = 10000
n_value = c()
for(i in 1:sim_n) {
  count = 0
  sum = 0
  while(sum <= 1) {
    u = runif(1)
    sum = sum + u
    count = count + 1
  }
  n_value[i] = count
}

mean(n_value)
```

## Question 4
```{r question 4}
# set seed
set.seed(1029)

# simulate
n_sim = 100000
n_value = c()
for (i in 1:n_sim) {
    count = 0
    prod = 1
  while(prod >=exp(-3)) {
    u = runif(1)
    prod = prod * u
    count = count + 1
  }
  n_value[i] = count
  
}
mean(n_value)
```

## Question 5
```{r question 5, warning=FALSE}
library(extraDistr)
set.seed(1029)
n_sim = 10000
n_list = numeric(n_sim) # a list to store all the values of the number of experiments
for (i in 1:n_sim) {
  d_list = c()
  statement = F
  n_value = 0
  while (statement == F) {
    sum = 0
    sum12 = sum(rdunif(2, 1, 6))
    n_value = n_value + 1
    d_list = c(d_list, sum12)
    for (j in 2:12) {
      within = as.numeric(j %in% d_list) # whether or not this outcome shows up in our experiments
      sum = sum + within
    }
    statement = (sum == 11)
  }
  n_list[i] = n_value
  }
round(mean(n_list))

```

## Question 6
#### (a)
Since $p_{j}=\frac{(j-1)!}{(j-r)!(r-1)!}p^r(1-p)^{j-r}$, $p_{j+1}=\frac{(j)!}{(j+1-r)!(r-1)!}p^r(1-p)^{j+1-r}$, we have $\frac{p_{j+1}}{p_{j}}=j(1-p)/(j+1-r)$

#### (b)